---
/**
 * FixedLoopFlowchart.astro
 *
 * Inline SVG component for the CORRECTED loop version of the Secret Number Game.
 * Used in Station 3 to show the fix (INPUT inside the loop).
 *
 * Source: docs/examples/secret-number-simple-loop-fixed.svg
 */

interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<figure class:list={['flowchart-container', className]}>
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 478 613' role='img' aria-labelledby='fixed-flowchart-title fixed-flowchart-desc' class='flowchart-svg'>
    <title id='fixed-flowchart-title'>Corrected Loop Flowchart</title>
    <desc id='fixed-flowchart-desc'>A flowchart showing the corrected loop logic: the loop now includes INPUT inside it, so the player can enter a new guess each time.</desc>

    <!-- Main program box (green with double lines) -->
    <g>
      <rect x='50' y='80' width='81.2' height='30' style='fill:#a5d6a7; stroke:#444; stroke-width:1'></rect>
      <line x1='60' y1='80' x2='60' y2='110' style='fill:#a5d6a7; stroke:#444; stroke-width:1'></line>
      <line x1='121.2' y1='80' x2='121.2' y2='110' style='fill:#a5d6a7; stroke:#444; stroke-width:1'></line>
      <title>Main</title>
      <text x='75' y='100' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='75' y='100'>Main</tspan>
      </text>
    </g>

    <!-- Output: Welcome message -->
    <g>
      <rect x='87' y='128.5' width='365.4' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "Welcome to the Secret Number Game!"</title>
      <text x='102' y='148.5' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='148.5'>output "Welcome to the Secret Number Game!"</tspan>
      </text>
    </g>

    <!-- Output: Thinking of a number -->
    <g>
      <rect x='87' y='177' width='303' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "I am thinking of a number."</title>
      <text x='102' y='197' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='197'>output "I am thinking of a number."</tspan>
      </text>
    </g>

    <!-- Output: Can you guess -->
    <g>
      <rect x='87' y='225.5' width='295.2' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "Can you guess what it is?"</title>
      <text x='102' y='245.5' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='245.5'>output "Can you guess what it is?"</tspan>
      </text>
    </g>

    <!-- Input: guess (first time, before the loop) -->
    <g>
      <rect x='87' y='274' width='115.8' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>input guess</title>
      <text x='102' y='294' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='294'>input guess</tspan>
      </text>
    </g>

    <!-- WHILE loop condition (purple) -->
    <g>
      <rect x='117' y='357.5' width='263' height='30' rx='3' ry='3' style='fill:#b39ddb; stroke:#444; stroke-width:1'></rect>
      <polygon points='87,372.5 117,342.5 147,372.5 117,402.5' style='fill:#b39ddb; stroke:#444; stroke-width:1'></polygon>
      <title>while guess is not correct</title>
      <text x='162' y='377.5' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='162' y='377.5'>while guess is not correct</tspan>
      </text>
      <text x='105.3' y='377.5' font-family='monospace' font-size='13' fill='#222'>for</text>
    </g>

    <!-- Output: Wrong guess (inside loop) -->
    <g>
      <rect x='137' y='412.5' width='279.6' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "Wrong guess. Try again!"</title>
      <text x='152' y='432.5' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='152' y='432.5'>output "Wrong guess. Try again!"</tspan>
      </text>
    </g>

    <!-- Input: guess (INSIDE the loop - THE FIX!) -->
    <g>
      <rect x='137' y='461' width='115.8' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>input guess</title>
      <text x='152' y='481' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='152' y='481'>input guess</tspan>
      </text>
    </g>

    <!-- Output: You got it! -->
    <g>
      <rect x='87' y='509.5' width='186' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "You got it!"</title>
      <text x='102' y='529.5' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='529.5'>output "You got it!"</tspan>
      </text>
    </g>

    <!-- Output: Thanks for playing -->
    <g>
      <rect x='87' y='558' width='248.4' height='30' rx='3' ry='3' style='fill:#90caf9; stroke:#444; stroke-width:1'></rect>
      <title>output "Thanks for playing!"</title>
      <text x='102' y='578' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='102' y='578'>output "Thanks for playing!"</tspan>
      </text>
    </g>

    <!-- Start oval -->
    <g>
      <rect x='25' y='13.75' width='84' height='24' style='fill:#fff59d; stroke:#444; stroke-width:1'></rect>
      <circle cx='25' cy='25' r='15' style='fill:#fff59d; stroke:#444; stroke-width:1'></circle>
      <title>start</title>
      <text x='55' y='30' font-family='monospace' font-size='13' fill='#222'>
        <tspan x='55' y='30'>start</tspan>
      </text>
    </g>

    <!-- Arrow: start to Main -->
    <g>
      <path d='M25,40 L25,91 Q25,95 29,95 L42,95' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M42,92 L50,95 L42,98 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to Welcome -->
    <g>
      <path d='M68.5,110 L68.5,139.5 Q68.5,143.5 72.5,143.5 L79,143.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,140.5 L87,143.5 L79,146.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to Thinking -->
    <g>
      <path d='M68.5,110 L68.5,188 Q68.5,192 72.5,192 L79,192' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,189 L87,192 L79,195 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to Can you guess -->
    <g>
      <path d='M68.5,110 L68.5,236.5 Q68.5,240.5 72.5,240.5 L79,240.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,237.5 L87,240.5 L79,243.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to Input -->
    <g>
      <path d='M68.5,110 L68.5,285 Q68.5,289 72.5,289 L79,289' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,286 L87,289 L79,292 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to WHILE -->
    <g>
      <path d='M68.5,110 L68.5,368.5 Q68.5,372.5 72.5,372.5 L79,372.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,369.5 L87,372.5 L79,375.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: WHILE to Wrong guess -->
    <g>
      <path d='M117,402.5 L117,423.5 Q117,427.5 121,427.5 L129,427.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M129,424.5 L137,427.5 L129,430.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: WHILE to Input (inside loop) -->
    <g>
      <path d='M117,402.5 L117,472 Q117,476 121,476 L129,476' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M129,473 L137,476 L129,479 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Input (inside loop) back to WHILE -->
    <g>
      <path d='M252.8,476 L432.6,476 Q436.6,476 436.6,472 L436.6,330.5 Q436.6,322.5 432.6,322.5 L125,322.5 Q117,322.5 117,326.5 L117,334.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M114,334.5 L117,342.5 L120,334.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to You got it -->
    <g>
      <path d='M68.5,110 L68.5,520.5 Q68.5,524.5 72.5,524.5 L79,524.5' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,521.5 L87,524.5 L79,527.5 Z' fill='#333'></path>
    </g>

    <!-- Arrow: Main to Thanks -->
    <g>
      <path d='M68.5,110 L68.5,569 Q68.5,573 72.5,573 L79,573' style='fill:none; stroke:#444; stroke-width:1'></path>
      <path d='M79,570 L87,573 L79,576 Z' fill='#333'></path>
    </g>
  </svg>
  <figcaption class='flowchart-caption'>The corrected loop: now INPUT is inside the loop</figcaption>
</figure>

<style>
  .flowchart-container {
    margin: 1.5rem 0;
    text-align: center;
  }

  .flowchart-svg {
    max-width: max(300px, 60%);
    height: auto;
    background: hsl(0, 0%, 98%);
    border: 1px solid hsl(0, 0%, 85%);
    border-radius: 0.5rem;
    padding: 1rem;
  }

  .flowchart-caption {
    margin-top: 0.75rem;
    font-size: 0.9rem;
    color: hsl(0, 0%, 40%);
    font-style: italic;
  }
</style>
